# 数据库实训第五周

## 任务概览

- 系统实现；
  - 可展示的系统；
    - 功能列表的检查和继续完成；（参考的基本功能如下）![image-20200623111253571](https://picbed-1301760901.cos.ap-guangzhou.myqcloud.com/image-20200623111253571.png)
  - 相关文档的完善
    - 过程管理：总结的进度安排和实际完成情况
    - 系统文档：改进提高系统的文档质量（用合适的uml和详细文字清楚描述软件系统）
    - 总结文档：过程管理的内容搬一下；以及思考总结一些这个背景下数据库相关的问题；![image-20200623112037777](https://picbed-1301760901.cos.ap-guangzhou.myqcloud.com/image-20200623112037777.png)

- 成果汇报

  - 一套前台的购物流程（2分钟）

    - 前台流程展示
    - 后台支持方式：数据表和后端逻辑
    - 实现方法在实际应用可能存在问题

  - 一套后台的管理流程（2分钟）

    - 后台流程展示
    - 后台支持方式：数据表和后端逻辑
    - 实现方法在实际应用可能存在问题

  - 文档完成情况展示（1分钟）

    > 体现文档完成的覆盖面、完成深度、是否准确清楚地描述了软件系统的各个方面

    - 覆盖面：安排的文档全部完成，同时参考国标软件文档体系，补充的文档全部撰写完成。
    - 完成深度：用例数、UML图数
    - 准确性：要提到

  - 开发进度说明（1分钟）

    > 体现过程管理，要有三个元素：初始计划，实际情况，调整

    - 最初的计划：总结对比，初始和实际
    - 每周的计划：对比计划和实际，体现调整。

  - 经验和总结（2分钟）

    - 对电商背景下数据库相关的问题的一些讨论和总结



## 前台购物展示流程

###  预期流程

1. **入口**：用户进入商城前台，有多种方式能进入具体查看相应的商品详情页面：**首页热门商品栏目和横幅、分类区**
2. **商品详情**：以热门商品栏目为例，选择感兴趣商品之后，进入商品的详情页面。在详情页面，用户可以对商品的各种信息：商品标题、品牌、店名、评论、商品简介等等进行查看
3. **选择规格并加入购物车**：在查看完信息准备购买时，需要选择相应的规格，进行立即购买或者加入购物车。以加入购物车为例，加入之后，购物车会出现刚刚加入的商品。
4. **在购物车进行结算**：我们选择好相应的商品，点击结算，会跳转到结算的页面，在这里可以调整用户的收货地址。
5. **支付后在订单管理查看订单状态**：点击支付后，会调用微信的支付接口进行支付，然后在订单管理模块生成一个对应的状态为已支付的订单。
6. **商家发货后订单状态转变**：商家发货后，该订单状态会转变为已发货。
7. **用户收货**：在用户收到货后，可以选择已收货，订单状态转变为未评价。
8. **用户评价商品**：在用户体验完一阵子商品后，可以对订单进行评价，订单状态变为最终的已评价状态。
9. **结束**：到此，就完成了一件商品的完整购物流程。

### 后台支持方式

> 分点对应前面的预期购物流程，最好顺带着说明下设计或者实现的亮点（如果有的话）

- **入口**

1. 首页商品宣传横幅

**由后台的sms_fontbanner表进行支持。**前台直接请求获取这个表的全部数据，并在前台进行渲染。

![image-20200623092817203](https://picbed-1301760901.cos.ap-guangzhou.myqcloud.com/image-20200623092817203.png)

![image-20200623092139655](https://picbed-1301760901.cos.ap-guangzhou.myqcloud.com/image-20200623092139655.png)

2. 首页热门商品栏目

**由后台的sms_hot表进行支持**。前台直接请求获取这个表的全部数据，并在前台进行渲染。

![image-20200623092745153](https://picbed-1301760901.cos.ap-guangzhou.myqcloud.com/image-20200623092745153.png)

![image-20200623092506972](https://picbed-1301760901.cos.ap-guangzhou.myqcloud.com/image-20200623092506972.png)

3. 前台二级分类栏目

由pms_product_category表支持，前台请求获取这个表分类的前两层的数据，并在前台进行渲染。

![image-20200623092906102](https://picbed-1301760901.cos.ap-guangzhou.myqcloud.com/image-20200623092906102.png)

![image-20200623092936126](https://picbed-1301760901.cos.ap-guangzhou.myqcloud.com/image-20200623092936126.png)

- **商品详情**

**主要由后台的pms_product表、pms_shop表、pms_brand表支持**。后台根据前台发送过来的product_id，在pms_product表中对应的行并返回该商品的所有数据，前台根据这些数据进行渲染。

![image-20200623093329642](https://picbed-1301760901.cos.ap-guangzhou.myqcloud.com/image-20200623093329642.png)

![image-20200623103059679](https://picbed-1301760901.cos.ap-guangzhou.myqcloud.com/image-20200623103059679.png)

![image-20200623103114950](https://picbed-1301760901.cos.ap-guangzhou.myqcloud.com/image-20200623103114950.png)

![image-20200623093505269](https://picbed-1301760901.cos.ap-guangzhou.myqcloud.com/image-20200623093505269.png)

- 商品规格

由三张属性相关的表和一张sku库存存储表实现。

属性表存储商品的属性信息，最小的一个属性由pms_product_attribute表存储，并通过pms_product_attribute_category进行归类整合为可以被商品所绑定的属性集合，属性的具体值可以存放在pms_product_attribute表的input_list字段中（在输入模式为下拉框选择时，此时对应一些属性值有特定离散值约束），手动输入属性类型的属性的值存放在pms_product_attribute_value表中。pms_product_category_attribute_relation用于存储同一类商品所共享的一系列最小属性。

![image-20200623101402729](https://picbed-1301760901.cos.ap-guangzhou.myqcloud.com/image-20200623101402729.png)

sku表用来控制商品的最小库存单位。后台通过前台发送的product_id，查询到对应的行，并将数据列表发送回前台。这里的stock是库存剩余量，sp_data是该sku对应的商品属性值。

![image-20200623101438507](https://picbed-1301760901.cos.ap-guangzhou.myqcloud.com/image-20200623101438507.png)



- 加入购物车

**此部分由oms_cart_item表来支持**

在加入购物车后，前台将商品加入购物车的数据传输到后台，后台将相应的字段存储这个表中。

![image-20200623101822652](https://picbed-1301760901.cos.ap-guangzhou.myqcloud.com/image-20200623101822652.png)

- 结算时的地址管理和运费模板

**此部分由pms_feight_template表、ums_member_receive_address表来支持**

结算时会根据商品和用户信息，查询相关的数据传输至前台。

![image-20200623102557547](https://picbed-1301760901.cos.ap-guangzhou.myqcloud.com/image-20200623102557547.png)

![image-20200623102503266](https://picbed-1301760901.cos.ap-guangzhou.myqcloud.com/image-20200623102503266.png)

- 支付后生成订单，以及后续的订单状态维护

**此部分由oms_order_item表和oms_order表支持**

在用户结算完毕后，下单的每一件商品信息都会被加入到oms_order_item表中，然后同一个订单的所有item总计的一些信息会被oms_order表记录。后续订单的信息变化将会吸怪oms_order的status相关的字段得到记录。

![image-20200623102403972](https://picbed-1301760901.cos.ap-guangzhou.myqcloud.com/image-20200623102403972.png)

- 用户评价

在用户对已经收货后的商品进行评价后，相关的评价信息会存储在pms_comment这个表中。

![image-20200623102917812](https://picbed-1301760901.cos.ap-guangzhou.myqcloud.com/image-20200623102917812.png)

### 不足之处

> 目前实现方法在实际应用中可能存在的问题



## 后台管理展示流程

### 预期流程

### 后台支持方式

> 分点对应前面的预期流程，最好顺带着说明下设计或者实现的亮点（如果有的话）

### 不足之处

> 目前实现方法在实际应用中可能存在的问题



## 软件文档完善



## 过程管理回顾



## 数据库设计经验总结



## 工作安排

1. **系统实现**：系统继续实现，主要是后台，做到能展示一个流程就停。——yh/lyx后端，jlq/hwy前端
2. **系统展示**：流程构思、后台支持方式说明、不足之处；前后台各一个展示。——lyx
3. **软件文档完善**：用合适的UML图和详细文字描述软件系统，完善之前的文档。达到程度：UML图一眼看过去还像个样子，有一定的复杂度；在一些情况下，也需要有文字的补充说明，不能光是图。——hwy/lyx
4. **过程管理总结**：回顾之前过程管理情况和材料，进行总结和记录整合。——lyx
5. **设计经验总结**：主要是对一些电商背景下数据库系统设计问题的思考和经验总结，除了本次个人遇到的问题总结，还有一些其他的收集途径：论文、博客、书籍等...这方面在汇报时介绍几个重要的就好，更多的放在总结文档里面。——ALL；分工情况如下（**小红字**），至少完成分配的一个问题的讨论，提交的讨论应该有体现多个方案的权衡和对比与最终选择方案原因。

![image-20200623122136278](https://picbed-1301760901.cos.ap-guangzhou.myqcloud.com/image-20200623122136278.png)

## 实现记录

### 后台功能列表

1. 商品管理：增删改查；加个shop字段，代替商家管理功能。
2. 用户信息管理：信息表增删改查
3. 用户统计信息：用户统计信息查看
4. 订单管理：订单大表的增删查改
5. 统计分析：①商家销量排名 ②用户下单量时序统计图

## 参考资料

1. 第五周周一ppt

![image-20200623085243919](C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20200623085243919.png)

![image-20200623105845625](https://picbed-1301760901.cos.ap-guangzhou.myqcloud.com/image-20200623105845625.png)

![image-20200623105929611](C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20200623105929611.png)

![image-20200622141656356](C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20200622141656356.png)

